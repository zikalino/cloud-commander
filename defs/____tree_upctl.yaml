- name: UpCloud
  id: cloud-upcloud
  icon: upcloud.png
  subitems:
    - name: Servers
      id: cloud-upcloud-servers
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl server list -o json
      path-id: $.servers[::].uuid
      path-name: $.servers[::].hostname
      path-raw: $.servers[::]
      operations:
      - type: create
        name: Create Server
        template: upctl_server_create
      child-template:
        - type: query-details
          query: upctl server show ${id} -o json
          refresh: self
          extract:
            - field: state
              path: "$.state"
            - field: size
              path: "$.plan"
            - field: location
              path: "$.zone"
            - field: size_cores
              path: "$.core_number"
            - field: size_memory
              path: "$.memory_amount"
            - field: size_disk
              path: "$[0].specs.disk"
            - field: image
              path: "$[0].image"
        - type: delete
          name: Delete
          cmd: upctl server delete ${id}
          refresh: parent
          when:
            path: state
            value: stopped
        - type: start
          name: Start
          cmd: upctl server start ${id}
          refresh: self
          when:
            path: state
            value: stopped
        - type: stop
          name: Stop
          cmd: upctl server stop ${id} --wait
          refresh: self
          when:
            path: state
            value: started
        - type: restart
          name: Restart
          cmd: upctl server restart ${id}
          refresh: self
          when:
            path: state
            value: started
    - name: Storage
      id: cloud-upcloud-storages
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl storage list -o json
      path-id: $.storages[::].uuid
      path-name: $.storages[::].title
      path-raw: $.storages[::]
      operations:
      - type: create
        name: Create Storage
        template: upctl_storage_create
      child-template:
        - type: delete
          name: Delete
          cmd: upctl storage delete ${id}
          refresh: parent
    - name: Server Groups
      id: cloud-upcloud-server-groups
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl servergroup list -o json
      path-id: $.server_groups[::].uuid
      path-name: $.server_groups[::].title
      path-raw: $.server_groups[::]
      operations:
      - type: create
        name: Create Server Group
        template: upctl_servergroup_create
      child-template:
        - type: delete
          name: Delete
          cmd: upctl servergroup delete ${id}
          refresh: parent
    - name: Databases
      id: cloud-upcloud-databases
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl database list -o json
      path-id: $.databases[::].uuid
      path-name: $.databases[::].title
      path-raw: $.databases[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl database delete ${id}
          refresh: parent
    - name: Gateways
      id: cloud-upcloud-gateways
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl gateway list -o json
      path-id: $.gateways[::].uuid
      path-name: $.gateways[::].name
      path-raw: $.gateways[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl gateway delete ${id}
          refresh: parent
    - name: IP Addresses
      id: cloud-upcloud-ip-addresses
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl ip-address list -o json
      path-id: $.ip_addresses.[::].address
      path-name: $.ip_addresses[::].address
      path-raw: $.ip_addresses[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl ip-address remove ${id}
          refresh: parent
    - name: Kubernetes
      id: cloud-upcloud-kubernetes
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl kubernetes list -o json
      path-id: $.[::].uuid
      path-name: $.[::].name
      path-raw: $.[::]
      operations:
      - type: create
        name: Create Kubernetes Cluster
        template: upctl_kubernetes_create
      child-template:
        - type: delete
          name: Delete
          cmd: upctl kubernetes delete ${id}
          refresh: parent
    - name: Hosts
      id: cloud-upcloud-hosts
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl host list -o json
      path-id: $.hosts[::].id
      path-name: $.hosts[::].description
      path-raw: $.hosts[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl host delete ${id}
          refresh: parent
    - name: Load Balancers
      id: cloud-upcloud-loadbalancers
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl loadbalancer list -o json
      path-id: $.loadbalancers[::].uuid
      path-name: $.loadbalancers[::].name
      path-raw: $.loadbalancers[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl loadbalancer delete ${id}
          refresh: parent
    - name: Networks
      id: cloud-upcloud-networks
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl network list -o json
      path-id: $.networks[::].uuid
      path-name: $.networks[::].name
      path-raw: $.networks[::]
      operations:
        - type: create
          name: Create Network
          template: upctl_network_create
      child-template:
        - type: delete
          name: Delete
          cmd: upctl network delete ${id}
          refresh: parent
    - name: Network Peerings
      id: cloud-upcloud-network-peerings
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl networkpeering list -o json
      path-id: $.networks[::].uuid
      path-name: $.networks[::].name
      path-raw: $.networks[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl networkpeering delete ${id}
          refresh: parent
    - name: Object Storages
      id: cloud-upcloud-object-storages
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl object-storage list -o json
      path-id: $.object_storages[::].uuid
      path-name: $.object_storages[::].name
      path-raw: $.object_storages[::]
      child-template:
        - type: delete
          name: Delete
          cmd: upctl object-storage delete ${id}
          refresh: parent
    - name: Routers
      id: cloud-upcloud-routers
      icon: upcloud.png
      subitems: []
      raw: {}
      query: upctl router list -o json
      path-id: $.routers[::].uuid
      path-name: $.routers[::].name
      path-raw: $.routers[::]
      operations:
        - type: create
          name: Create Router
          template: upctl_router_create
      child-template:
        - type: delete
          name: Delete
          cmd: upctl router delete ${id}
          refresh: parent
  raw: {}
  details: upctl__prerequisites.yaml

- name: Civo
  id: cloud-civo
  icon: civo.png
  subitems:
    - name: Instances
      id: cloud-civo-instances
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo instances list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].hostname
        path-raw: $[::]
      operations:
        - type: create
          name: Create Instance
          template:
            name: generic/generic_vm_create
            parameters:
              cloud_provider: cloud-civo

      #child-template:
      #  - type: query-details
      #    query: doctl compute droplet get ${id} -o json
      #    refresh: self
      #    extract:
      #      - field: state
      #        path: "$[0].status"
      #        map:
      #          active: started
      #          off: stopped
      #      - field: size
      #        path: "$[0].size.slug"
      #      - field: location
      #        path: "$[0].region.slug"
      #      - field: size_cores
      #        path: "$[0].size.vcpus"
      #      - field: size_memory
      #        path: "$[0].size.memory"
      #      - field: size_disk
      #        path: "$[0].size.disk"
      #      - field: price
      #        path: "$[0].size.price_monthly"
      #      - field: image
      #        path: "$[0].image.slug"
      #  - type: delete
      #    name: Delete
      #    cmd: doctl compute droplet delete ${id} --force
      #    refresh: parent
      #  - type: reboot
      #    name: Reboot
      #    cmd: doctl compute droplet-action reboot ${id}
      #    when:
      #      path: "$[0].status"
      #      value: active
      #    refresh: self
      #  - type: power-off
      #    name: Power off
      #    cmd: doctl compute droplet-action power-off ${id}
      #    when:
      #      path: "$[0].status"
      #      value: active
      #    refresh: self
      #  - type: power-on
      #    name: Power on
      #    cmd: doctl compute droplet-action power-on ${id}
      #    when:
      #      path: "$[0].status"
      #      value: off
      #    refresh: self
      #  - type: other
      #    name: Enable backups
      #    cmd: doctl compute droplet-action enable-backups ${id}
      #    refresh: self
      #    #when:
      #    #  path: "$[0].status"
      #    #  value: on
      #  - type: other
      #    name: Disable backups
      #    cmd: doctl compute droplet-action disable-backups ${id}
      #    refresh: self
      #    #when:
      #    #  path: "$[0].status"
      #    #  value: off

    - name: Kubernetes
      id: cloud-civo-kubernetes
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo kubernetes list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]
      operations:
        - type: create
          name: Create Kubernetes Cluster
          template:
            name: generic/generic_kubernetes_create
            parameters:
              cloud_provider: cloud-civo
      child-template:
        # this is a template for resource group level
        - type: delete
          name: Delete
          cmd: civo kubernetes delete ${name} --region fra1
          refresh: parent
        # This is copied from level below, but is exactly the same
        - type: query-details
          query: civo kubernetes show ${id} --region fra1 --output json
          refresh: self
          #extract:
          #  - field: location
          #    path: "$.location"

    - name: Load Balancers
      id: cloud-civo-loadbalancers
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo loadbalancer list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

    - name: Firewalls
      id: cloud-civo-firewalls
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo firewall list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

    - name: API Keys
      id: cloud-civo-apikeys
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo apikey list --region fra1 --output json
        path-id: $[::].name
        path-name: $[::].name
        path-raw: $[::]

    - name: Databases
      id: cloud-civo-databases
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo database list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

    - name: Domains
      id: cloud-civo-domains
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo domain list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

    - name: IP Addresses
      id: cloud-civo-ips
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo ip list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

    - name: Networks
      id: cloud-civo-network
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo network list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].label
        path-raw: $[::]

    - name: Object Stores
      id: cloud-civo-objectstores
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo objectstore list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

    - name: SSH Keys
      id: cloud-civo-volumes
      icon: civo.png
      subitems: []
      raw: {}
      source:
        cmd: civo volume list --region fra1 --output json
        path-id: $[::].id
        path-name: $[::].name
        path-raw: $[::]

  raw: {}
  details: civo/civo__prerequisites.yaml

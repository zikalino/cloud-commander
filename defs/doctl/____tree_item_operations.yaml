#
# doctl
# 
- type: create
  item-types: doctl-droplet
  name: Create Droplet
  template:
    name: generic/generic_vm_create
    parameters:
      cloud_provider: cloud-doctl

- type: delete
  item-types: doctl-droplet
  name: Delete
  cmd: doctl compute droplet delete ${id} --force
  refresh: parent
- type: reboot
  item-types: doctl-droplet
  name: Reboot
  cmd: doctl compute droplet-action reboot ${id}
  when:
    path: "$[0].status"
    value: active
  refresh: self
- type: power-off
  item-types: doctl-droplet
  name: Power off
  cmd: doctl compute droplet-action power-off ${id}
  when:
    path: "$[0].status"
    value: active
  refresh: self
- type: power-on
  item-types: doctl-droplet
  name: Power on
  cmd: doctl compute droplet-action power-on ${id}
  when:
    path: "$[0].status"
    value: off
  refresh: self
- type: other
  item-types: doctl-droplet
  name: Enable backups
  cmd: doctl compute droplet-action enable-backups ${id}
  refresh: self
  #when:
  #  path: "$[0].status"
  #  value: on
- type: other
  item-types: doctl-droplet
  name: Disable backups
  cmd: doctl compute droplet-action disable-backups ${id}
  refresh: self
  #when:
  #  path: "$[0].status"
  #  value: off

- type: create
  item-types: doctl-volume
  name: Create Volume
  template: doctl_compute_volume_create
- type: delete
  item-types: doctl-volume
  name: Delete
  cmd: doctl compute volume delete ${id} --force
  refresh: parent
- type: other
  item-types: doctl-volume
  name: Resize
  cmd: doctl compute volume-action resize ${id}
  refresh: self
- type: other
  item-types: doctl-volume
  name: Attach
  cmd: doctl compute volume-action attach ${id}
  refresh: self
- type: other
  item-types: doctl-volume
  name: Detach
  cmd: doctl compute volume-action detach ${id}
  refresh: self
- type: create
  item-types: doctl-kubernetes
  name: Create Kubernetes Cluster
  template: doctl_kubernetes_cluster_create
- type: delete
  item-types: doctl-kubernetes
  name: Delete
  cmd: doctl kubernetes cluster delete ${id} --force
  refresh: parent
- type: create
  item-types: doctl-database
  name: Create Database
  template: doctl_databases_create
- type: delete
  item-types: doctl-database
  name: Delete
  cmd: doctl databases delete ${id} --force
  refresh: parent
- type: create
  item-types: doctl-firewall
  name: Create Firewall
  template: doctl_compute_firewall_create
- type: delete
  item-types: doctl-firewall
  name: Delete
  cmd: doctl compute firewall delete ${id}
  refresh: parent
- type: create
  item-types: doctl-containerregistry
  name: Create Container Registry
  template: doctl_registry_create
- type: delete
  item-types: doctl-containerregistry
  name: Delete
  cmd: doctl registry delete ${id}
  refresh: parent

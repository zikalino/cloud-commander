#
# az
#
- type: create
  item-types: az-group
  name: Create Resource Group
  template: az_group_create
- type: create
  item-types: 
    - vm
  name: Create Virtual Machine
  template:
    name: generic/generic_vm_create
    parameters:
      cloud_provider: cloud-az
- type: create
  item-types:
    - "Microsoft.Compute/containerRegistry"
  name: Create Container Registry
  template: az_acr_create
# this is a template for resource group level
- type: delete
  item-types:
    - "Microsoft.Compute/virtualMachines"
  name: Delete
  cmd: az resource delete --ids ${id}
  refresh: parent
- type: start
  item-types: "Microsoft.Compute/virtualMachines"
  name: Start
  cmd: az vm start --ids ${id}
  refresh: self
  when:
    path: "$.instanceView.statuses[?(@.code < 'ProvisioningState')].code"
    value: "PowerState/stopped"
- type: stop
  item-types: "Microsoft.Compute/virtualMachines"
  name: Stop
  cmd: az vm stop --ids ${id}
  refresh: self
  when:
    path: "$.instanceView.statuses[?(@.code < 'ProvisioningState')].code"
    value: "PowerState/running"
- type: restart
  item-types: "Microsoft.Compute/virtualMachines"
  name: Restart
  cmd: az vm restart --ids ${id}
  refresh: self
  when:
    path: "$.instanceView.statuses[?(@.code < 'ProvisioningState')].code"
    value: "PowerState/running"
